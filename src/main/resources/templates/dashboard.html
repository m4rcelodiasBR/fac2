<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/mainLayout :: layout(~{::title}, ~{::section}, ~{})}">
<head>
    <title>Dashboard - FACDigital</title>
</head>
<body>
<section>
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Dashboard do Avaliador</h1>
        <div class="btn-toolbar mb-2 mb-md-0">
            <!-- Botão para carregar XML (será implementado futuramente) -->
            <button type="button" class="btn btn-sm btn-outline-secondary">
                Carregar Nova FAC (XML)
            </button>
        </div>
    </div>

    <h2 class="h4">Minhas Avaliações</h2>
    <div class="table-responsive">
        <!--
          th:if verifica se a lista de avaliações NÃO está vazia.
          Se estiver vazia, a tabela não será renderizada.
        -->
        <table class="table table-striped table-hover" th:if="${!avaliacoes.isEmpty()}">
            <thead>
            <tr>
                <th scope="col">#ID</th>
                <th scope="col">Evento</th>
                <th scope="col">Data Limite</th>
                <th scope="col">Data de Envio</th>
                <th scope="col">Status</th>
                <th scope="col">Ação</th>
            </tr>
            </thead>
            <tbody>
            <!--
              th:each itera sobre a lista 'avaliacoes' que passamos do controller.
              Para cada item na lista, ele cria uma nova linha <tr>.
            -->
            <tr th:each="avaliacao : ${avaliacoes}">
                <td th:text="${avaliacao.id}">1</td>
                <td th:text="${avaliacao.eventoDescricao}">QAE-CMG</td>
                <td th:text="${#temporals.format(avaliacao.dataLimiteRemessa, 'dd/MM/yyyy')}">30/11/2025</td>
                <td th:text="${avaliacao.dataEnvio != null ? #temporals.format(avaliacao.dataEnvio, 'dd/MM/yyyy HH:mm') : '-'}">
                    -
                </td>
                <td>
                    <!-- Exemplo de como usar th:switch para estilizar o status -->
                    <span th:switch="${avaliacao.status.name()}" class="badge">
                                <span th:case="'INICIADA'" class="bg-secondary">Iniciada</span>
                                <span th:case="'EM_PROGRESSO'" class="bg-warning text-dark">Em Progresso</span>
                                <span th:case="'CONCLUIDA'" class="bg-success">Concluída</span>
                                <span th:case="'RETIFICADA'" class="bg-info text-dark">Retificada</span>
                            </span>
                </td>
                <td>
                    <!-- Link para a página de avaliação (será implementado futuramente) -->
                    <a href="#" class="btn btn-sm btn-primary">
                        {{(avaliacao.status.name() == 'CONCLUIDA' || avaliacao.status.name() == 'RETIFICADA') ?
                        'Visualizar' : 'Continuar'}}
                    </a>
                </td>
            </tr>
            </tbody>
        </table>

        <!--
          th:unless é o oposto de th:if.
          Este bloco só será renderizado se a lista de avaliações ESTIVER vazia.
        -->
        <div th:unless="${!avaliacoes.isEmpty()}" class="alert alert-info mt-3" role="alert">
            Você ainda não possui nenhuma avaliação carregada no sistema.
        </div>
    </div>
</section>
</body>
</html>